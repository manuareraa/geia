"use strict";(self.webpackChunkgeoblocs=self.webpackChunkgeoblocs||[]).push([[6131],{66131:function(e,t,n){n.r(t),n.d(t,{InjectedConnector:function(){return y}});var r=n(29439),a=n(74165),i=n(15861),s=n(1413),c=n(15671),o=n(43144),u=n(97326),h=n(60136),d=n(29388),p=n(93433),l=n(37762),v=n(2600),f=n(69822),m=n(38690),g=n(66072),w=n(83506),x=n(97419),k=n(60723),b=n(49716),Z=n(91609);n(65892);var y=function(e){(0,h.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;(0,c.Z)(this,n);var o={shimDisconnect:!0,getProvider:function(){if((0,g.a)(globalThis.window))return globalThis.window.ethereum}},h=(0,s.Z)((0,s.Z)({},o),e.options);r=t.call(this,{chains:e.chains,options:h}),(0,v._)((0,u.Z)(r),"shimDisconnectKey","injected.shimDisconnect"),(0,v._)((0,u.Z)(r),"onAccountsChanged",function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0===t.length?r.emit("disconnect"):r.emit("change",{account:x.getAddress(t[0])});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,v._)((0,u.Z)(r),"onChainChanged",(function(e){var t=(0,Z.n)(e),n=r.isChainUnsupported(t);r.emit("change",{chain:{id:t,unsupported:n}})})),(0,v._)((0,u.Z)(r),"onDisconnect",function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1013!==t.code){e.next=15;break}return e.next=3,r.getProvider();case 3:if(!e.sent){e.next=15;break}return e.prev=5,e.next=8,r.getAccount();case 8:if(!e.sent){e.next=11;break}return e.abrupt("return");case 11:e.next=15;break;case 13:e.prev=13,e.t0=e.catch(5);case 15:if(r.emit("disconnect"),!r.options.shimDisconnect){e.next=19;break}return e.next=19,r.connectorStorage.removeItem(r.shimDisconnectKey);case 19:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}());var d=h.getProvider();if("string"===typeof h.name)r.name=h.name;else if(d){var f=function(e){var t,n;if(!e)return"Injected";var r=function(e){return e.isAvalanche?"Core Wallet":e.isBitKeep?"BitKeep":e.isBraveWallet?"Brave Wallet":e.isCoinbaseWallet?"Coinbase Wallet":e.isExodus?"Exodus":e.isFrame?"Frame":e.isKuCoinWallet?"KuCoin Wallet":e.isMathWallet?"MathWallet":e.isOneInchIOSWallet||e.isOneInchAndroidWallet?"1inch Wallet":e.isOpera?"Opera":e.isPortal?"Ripio Portal":e.isTally?"Tally":e.isTokenPocket?"TokenPocket":e.isTokenary?"Tokenary":e.isTrust||e.isTrustWallet?"Trust Wallet":e.isMetaMask?"MetaMask":void 0};if(null!==(t=e.providers)&&void 0!==t&&t.length){var a,i,s=new Set,c=1,o=(0,l.Z)(e.providers);try{for(o.s();!(i=o.n()).done;){var u=r(i.value);u||(u="Unknown Wallet #".concat(c),c+=1),s.add(u)}}catch(d){o.e(d)}finally{o.f()}var h=(0,p.Z)(s);return h.length?h:null!==(a=h[0])&&void 0!==a?a:"Injected"}return null!==(n=r(e))&&void 0!==n?n:"Injected"}(d);h.name?r.name=h.name(f):r.name="string"===typeof f?f:f[0]}else r.name="Injected";return r.id="injected",r.ready=!!d,r.connectorStorage=e.connectorStorage,r}return(0,o.Z)(n,[{key:"connect",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t,n,r,i,s,c,o,u=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},e.prev=1,e.next=4,this.getProvider();case 4:if(n=e.sent){e.next=7;break}throw new m.a;case 7:return this.setupListeners(),this.emit("message",{type:"connecting"}),e.next=11,n.request({method:"eth_requestAccounts"});case 11:return r=e.sent,i=x.getAddress(r[0]),e.next=15,this.getChainId();case 15:if(s=e.sent,c=this.isChainUnsupported(s),!t.chainId||s===t.chainId){e.next=28;break}return e.prev=18,e.next=21,this.switchChain(t.chainId);case 21:s=t.chainId,c=this.isChainUnsupported(t.chainId),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(18),console.error("Could not switch to chain id: ".concat(t.chainId),e.t0);case 28:if(!this.options.shimDisconnect){e.next=31;break}return e.next=31,this.connectorStorage.setItem(this.shimDisconnectKey,"true");case 31:return o={account:i,chain:{id:s,unsupported:c},provider:n},this.emit("connect",o),e.abrupt("return",o);case 36:if(e.prev=36,e.t1=e.catch(1),!this.isUserRejectedRequestError(e.t1)){e.next=40;break}throw new m.U(e.t1);case 40:if(-32002!==e.t1.code){e.next=42;break}throw new m.R(e.t1);case 42:throw e.t1;case 43:case"end":return e.stop()}}),e,this,[[1,36],[18,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:if(null!==(t=e.sent)&&void 0!==t&&t.removeListener){e.next=5;break}return e.abrupt("return");case 5:if(t.removeListener("accountsChanged",this.onAccountsChanged),t.removeListener("chainChanged",this.onChainChanged),t.removeListener("disconnect",this.onDisconnect),!this.options.shimDisconnect){e.next=11;break}return e.next=11,this.connectorStorage.removeItem(this.shimDisconnectKey);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAccount",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:if(t=e.sent){e.next=5;break}throw new m.a;case 5:return e.next=7,t.request({method:"eth_accounts"});case 7:return n=e.sent,e.abrupt("return",x.getAddress(n[0]));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getChainId",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:if(t=e.sent){e.next=5;break}throw new m.a;case 5:return e.abrupt("return",t.request({method:"eth_chainId"}).then(Z.n));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getProvider",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.options.getProvider())&&(this._provider=t),e.abrupt("return",this._provider);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSigner",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t,n,i,s,c,o=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(o.length>0&&void 0!==o[0]?o[0]:{}).chainId,e.next=3,Promise.all([this.getProvider(),this.getAccount()]);case 3:return n=e.sent,i=(0,r.Z)(n,2),s=i[0],c=i[1],e.abrupt("return",new k.Q(s,t).getSigner(c));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isAuthorized",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=this.options.shimDisconnect,!e.t0){e.next=8;break}return e.t1=Boolean,e.next=6,this.connectorStorage.getItem(this.shimDisconnectKey);case 6:e.t2=e.sent,e.t0=!(0,e.t1)(e.t2);case 8:if(!e.t0){e.next=10;break}return e.abrupt("return",!1);case 10:return e.next=12,this.getProvider();case 12:if(e.sent){e.next=15;break}throw new m.a;case 15:return e.next=17,this.getAccount();case 17:return t=e.sent,e.abrupt("return",!!t);case 21:return e.prev=21,e.t3=e.catch(0),e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,this,[[0,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"switchChain",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n,r,i,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:if(n=e.sent){e.next=5;break}throw new m.a;case 5:return r=b.hexValue(t),e.prev=6,e.next=9,n.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]});case 9:if(!(i=this.chains.find((function(e){return e.chainId===t})))){e.next=12;break}return e.abrupt("return",i);case 12:return e.abrupt("return",{chainId:t,name:"Chain ".concat(r),slug:"".concat(r),nativeCurrency:{name:"Ether",decimals:18,symbol:"ETH"},rpc:[""],chain:"",shortName:"",testnet:!0});case 15:if(e.prev=15,e.t0=e.catch(6),c=this.chains.find((function(e){return e.chainId===t}))){e.next=20;break}throw new m.C({chainId:t,connectorId:this.id});case 20:if(4902!==e.t0.code&&4902!==(null===e.t0||void 0===e.t0||null===(s=e.t0.data)||void 0===s||null===(s=s.originalError)||void 0===s?void 0:s.code)){e.next=32;break}return e.prev=21,e.next=24,n.request({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:c.name,nativeCurrency:c.nativeCurrency,rpcUrls:(0,w.g)(c),blockExplorerUrls:this.getBlockExplorerUrls(c)}]});case 24:return e.abrupt("return",c);case 27:if(e.prev=27,e.t1=e.catch(21),!this.isUserRejectedRequestError(e.t1)){e.next=31;break}throw new m.U(e.t0);case 31:throw new m.A;case 32:if(!this.isUserRejectedRequestError(e.t0)){e.next=34;break}throw new m.U(e.t0);case 34:throw new m.S(e.t0);case 35:case"end":return e.stop()}}),e,this,[[6,15],[21,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setupListeners",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:(t=e.sent).on&&(t.on("accountsChanged",this.onAccountsChanged),t.on("chainChanged",this.onChainChanged),t.on("disconnect",this.onDisconnect));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUserRejectedRequestError",value:function(e){return 4001===e.code}}]),n}(f.W)}}]);
//# sourceMappingURL=6131.50bc28e3.chunk.js.map
(self.webpackChunkgeoblocs=self.webpackChunkgeoblocs||[]).push([[6245],{71092:function(e,t,n){"use strict";n.r(t),n.d(t,{SafeConnector:function(){return F}});var r=n(74165),a=n(15861),s=n(15671),i=n(43144),c=n(97326),o=n(60136),u=n(29388),f=n(9302),p=n(57591),h=n(7338),l=n(34029),d=n(2273),b=n(68624),g=n(97419),v=n(33469),A=n(29521),x=n.n(A),y=n(13057),w=n.n(y),k=(n(38080),{1:"https://safe-transaction-mainnet.safe.global",11155111:"https://safe-transaction-sepolia.safe.global",10:"https://safe-transaction-optimism.safe.global",56:"https://safe-transaction-bsc.safe.global",100:"https://safe-transaction-gnosis-chain.safe.global",137:"https://safe-transaction-polygon.safe.global",43114:"https://safe-transaction-avalanche.safe.global",42161:"https://safe-transaction-arbitrum.safe.global",42220:"https://safe-transaction-celo.safe.global",8453:"https://safe-transaction-base.safe.global",1313161554:"https://safe-transaction-aurora.safe.global",1101:"https://safe-transaction-zkevm.safe.global",324:"https://safe-transaction-zksync.safe.global"}),Z={1:"0xA65387F16B013cf2Af4605Ad8aA5ec25a2cbA3a2",137:"0xA65387F16B013cf2Af4605Ad8aA5ec25a2cbA3a2",56:"0xA65387F16B013cf2Af4605Ad8aA5ec25a2cbA3a2",42161:"0xA65387F16B013cf2Af4605Ad8aA5ec25a2cbA3a2",1313161554:"0xA65387F16B013cf2Af4605Ad8aA5ec25a2cbA3a2",43114:"0x98FFBBF51bb33A056B08ddf711f289936AafF717",10:"0x98FFBBF51bb33A056B08ddf711f289936AafF717",42220:"0x98FFBBF51bb33A056B08ddf711f289936AafF717",100:"0xA65387F16B013cf2Af4605Ad8aA5ec25a2cbA3a2",11155111:"0x98FFBBF51bb33A056B08ddf711f289936AafF717",8453:"0x98FFBBF51bb33A056B08ddf711f289936AafF717",1101:"0xA65387F16B013cf2Af4605Ad8aA5ec25a2cbA3a2",324:"0x357147caf9C0cCa67DfA0CF5369318d8193c8407"},m=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"msgHash",type:"bytes32"}],name:"SignMsg",type:"event"},{inputs:[{internalType:"bytes",name:"message",type:"bytes"}],name:"getMessageHash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"_data",type:"bytes"}],name:"signMessage",outputs:[],stateMutability:"nonpayable",type:"function"}],F=function(e){(0,o.Z)(n,e);var t=(0,u.Z)(n);function n(){var e;return(0,s.Z)(this,n),e=t.call(this),(0,f._)((0,c.Z)(e),"supportedChains",n.supportedChains),(0,f._)((0,c.Z)(e),"id","safe-wallet"),(0,f._)((0,c.Z)(e),"ready",!0),(0,f._)((0,c.Z)(e),"name","Safe Wallet"),e.ready=!0,e}return(0,i.Z)(n,[{key:"connect",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.chain.chainId in k){e.next=2;break}throw new Error("Chain not supported by Safe");case 2:return e.next=4,this.createSafeSigner(t);case 4:return this.safeSigner=e.sent,e.next=7,this.getAddress();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSafeSigner",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,s,i,c,o,u,f,p,g;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.personalWallet=t.personalWallet,e.next=3,t.personalWallet.getSigner();case 3:if(n=e.sent,s=t.safeAddress,i=t.chain.chainId,n){e.next=8;break}throw new Error("cannot create Gnosis Safe signer without a personal signer");case 8:return e.next=10,n.getChainId();case 10:if(e.sent===i){e.next=13;break}throw new Error("chainId of personal signer has to match safe chainId");case 13:if(s){e.next=15;break}throw new Error("safeAddress is required");case 15:if(i){e.next=17;break}throw new Error("safeChainId is required");case 17:if(o=Z[i],(c=k[i])&&o){e.next=21;break}throw new Error("Chain not supported");case 21:return u=new(w())({ethers:h,signerOrProvider:n}),e.next=24,x().create({ethAdapter:u,safeAddress:s});case 24:return f=e.sent,p=new v.SafeService(c),(g=new v.SafeEthersSigner(f,p,n.provider)).signMessage=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a,s,i,c,u,h,g,v,A,x;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new l.VZ(o,m),s=a.interface.encodeFunctionData("signMessage",[d.r(t)]),i=o,"0",1,5e4,5e4,0,c=b.d,u=b.d,e.next=12,f.createTransaction({safeTransactionData:{to:i,value:"0",operation:1,data:s,baseGas:5e4,safeTxGas:5e4,gasPrice:0,gasToken:c,refundReceiver:u}});case 12:return h=e.sent,e.next=15,f.getTransactionHash(h);case 15:return g=e.sent,e.next=18,f.signTransactionHash(g);case 18:return v=e.sent,e.next=21,p.proposeTx(f.getAddress(),g,h,v);case 21:return e.prev=22,e.next=25,p.getSafeTxDetails(g);case 25:if(!(A=e.sent).transactionHash){e.next=30;break}return e.next=29,null===(x=n.provider)||void 0===x?void 0:x.waitForTransaction(A.transactionHash);case 29:return e.abrupt("break",38);case 30:e.next=34;break;case 32:e.prev=32,e.t0=e.catch(22);case 34:return e.next=36,new Promise((function(e){return setTimeout(e,5e3)}));case 36:e.next=21;break;case 38:return e.abrupt("return","0x");case 39:case"end":return e.stop()}}),e,null,[[22,32]])})));return function(t){return e.apply(this,arguments)}}(),this.previousConnector=t.personalWallet,e.abrupt("return",g);case 30:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.safeSigner=void 0,this.previousConnector=void 0,e.abrupt("return",void 0);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAddress",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSigner();case 2:return t=e.sent,e.next=5,t.getAddress();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getChainId",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSigner();case 2:return e.abrupt("return",e.sent.getChainId());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getProvider",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSigner();case 2:if(t=e.sent.provider){e.next=5;break}throw new Error("No provider available");case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSigner",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.safeSigner){e.next=2;break}throw new Error("not connected - please call connect() first");case 2:return e.abrupt("return",this.safeSigner);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isConnected",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAddress();case 3:return t=e.sent,e.abrupt("return",!!t);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAccountsChanged",value:function(e){0===e.length?this.emit("disconnect"):e[0]&&this.emit("change",{account:g.getAddress(e[0])})}},{key:"onDisconnect",value:function(){this.emit("disconnect")}},{key:"switchChain",value:function(){throw new Error("Safe connector does not support switching chains")}},{key:"updateChains",value:function(){}},{key:"setupListeners",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(p.C);(0,f._)(F,"supportedChains",function(){return Object.keys(k)}())},89214:function(){},85568:function(){},52361:function(){},94616:function(){}}]);
//# sourceMappingURL=6245.e447fc30.chunk.js.map
"use strict";(self.webpackChunkgeoblocs=self.webpackChunkgeoblocs||[]).push([[5590],{72106:function(t,r,e){e.d(r,{C:function(){return s}});var n=e(15671),a=e(43144),s=function(){function t(r){(0,n.Z)(this,t),this.contractWrapper=r}return(0,a.Z)(t,[{key:"overrideNextTransaction",value:function(t){this.contractWrapper.withTransactionOverride(t)}}]),t}()},85590:function(t,r,e){e.r(r),e.d(r,{Vote:function(){return Z}});var n=e(29439),a=e(74165),s=e(15861),o=e(15671),c=e(43144),u=e(4942),i=e(51583),p=e(2257),f=e(6222),h=e(34029),l=e(87126),d=e(18392),v=e(12644),x=e(17953),k=e(72106),g=function(t){return t[t.Against=0]="Against",t[t.For=1]="For",t[t.Abstain=2]="Abstain",t}({}),Z=(e(80518),e(66315),e(98528),function(){function t(r,e,n){var c=this;(0,o.Z)(this,t),(0,u.Z)(this,"propose",(0,v.f)(function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r,e){var n,s,o;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e||(e=[{toAddress:c.contractWrapper.address,nativeTokenValue:0,transactionData:"0x"}]),n=e.map((function(t){return t.toAddress})),s=e.map((function(t){return t.nativeTokenValue})),o=e.map((function(t){return t.transactionData})),t.abrupt("return",v.T.fromContractWrapper({contractWrapper:c.contractWrapper,method:"propose",args:[n,s,o,r],parse:function(t){return{id:c.contractWrapper.parseLogs("ProposalCreated",null===t||void 0===t?void 0:t.logs)[0].args.proposalId,receipt:t}}}));case 5:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}())),(0,u.Z)(this,"vote",(0,v.f)(function(){var t=c;return function(){var r=(0,s.Z)((0,a.Z)().mark((function r(e,n){var s,o=arguments;return(0,a.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=o.length>2&&void 0!==o[2]?o[2]:"",r.next=3,t.ensureExists(e);case 3:return r.abrupt("return",v.T.fromContractWrapper({contractWrapper:t.contractWrapper,method:"castVoteWithReason",args:[e,n,s]}));case 4:case"end":return r.stop()}}),r)})));return function(t,e){return r.apply(this,arguments)}}()}())),(0,u.Z)(this,"execute",(0,v.f)(function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r){var e,n,s,o,u;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.ensureExists(r);case 2:return t.next=4,c.get(r);case 4:return e=t.sent,n=e.executions.map((function(t){return t.toAddress})),s=e.executions.map((function(t){return t.nativeTokenValue})),o=e.executions.map((function(t){return t.transactionData})),u=i.id(e.description),t.abrupt("return",v.T.fromContractWrapper({contractWrapper:c.contractWrapper,method:"execute",args:[n,s,o,u]}));case 10:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()));var p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},f=arguments.length>4?arguments[4]:void 0,h=arguments.length>5?arguments[5]:void 0,g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new d.cs(r,e,f,p,n);this._chainId=h,this.abi=d.bk.parse(f||[]),this.contractWrapper=g,this.storage=n,this.metadata=new x.C(this.contractWrapper,d.cp,this.storage),this.app=new x.b(this.contractWrapper,this.metadata,this.storage),this.encoder=new l.C(this.contractWrapper),this.estimator=new x.G(this.contractWrapper),this.events=new x.a(this.contractWrapper),this.interceptor=new k.C(this.contractWrapper)}return(0,c.Z)(t,[{key:"chainId",get:function(){return this._chainId}},{key:"onNetworkUpdated",value:function(t){this.contractWrapper.updateSignerOrProvider(t)}},{key:"getAddress",value:function(){return this.contractWrapper.address}},{key:"get",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r){var e,n;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getAll();case 2:if(e=t.sent,0!==(n=e.filter((function(t){return t.proposalId.eq(p.O$.from(r))}))).length){t.next=6;break}throw new Error("proposal not found");case 6:return t.abrupt("return",n[0]);case 7:case"end":return t.stop()}}),t,this)})));return function(r){return t.apply(this,arguments)}}()},{key:"getAll",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(){var r,e,s,o=this;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contractWrapper.read("getAllProposals",[]);case 2:if(t.t1=r=t.sent,t.t0=null!==t.t1,!t.t0){t.next=6;break}t.t0=void 0!==r;case 6:if(!t.t0){t.next=10;break}t.t2=r,t.next=11;break;case 10:t.t2=[];case 11:return e=t.t2,t.next=14,Promise.all(e.map((function(t){return Promise.all([o.contractWrapper.read("state",[t.proposalId]),o.getProposalVotes(t.proposalId)])})));case 14:return s=t.sent,t.abrupt("return",s.map((function(t,r){var a=(0,n.Z)(t,2),s=a[0],o=a[1],c=e[r];return{proposalId:c.proposalId,proposer:c.proposer,description:c.description,startBlock:c.startBlock,endBlock:c.endBlock,state:s,votes:o,executions:c[3].map((function(t,r){return{toAddress:c.targets[r],nativeTokenValue:t,transactionData:c.calldatas[r]}}))}})));case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getProposalVotes",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r){var e;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contractWrapper.read("proposalVotes",[r]);case 2:return e=t.sent,t.abrupt("return",[{type:g.Against,label:"Against",count:e.againstVotes},{type:g.For,label:"For",count:e.forVotes},{type:g.Abstain,label:"Abstain",count:e.abstainVotes}]);case 4:case"end":return t.stop()}}),t,this)})));return function(r){return t.apply(this,arguments)}}()},{key:"hasVoted",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r,e){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=4;break}return t.next=3,this.contractWrapper.getSignerAddress();case 3:e=t.sent;case 4:return t.t0=this.contractWrapper,t.t1=r,t.next=8,(0,d.aM)(e);case 8:return t.t2=t.sent,t.t3=[t.t1,t.t2],t.abrupt("return",t.t0.read.call(t.t0,"hasVoted",t.t3));case 11:case"end":return t.stop()}}),t,this)})));return function(r,e){return t.apply(this,arguments)}}()},{key:"canExecute",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r){var e,n,s,o,c;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureExists(r);case 2:return t.next=4,this.get(r);case 4:return e=t.sent,n=e.executions.map((function(t){return t.toAddress})),s=e.executions.map((function(t){return t.nativeTokenValue})),o=e.executions.map((function(t){return t.transactionData})),c=i.id(e.description),t.prev=9,t.next=12,this.contractWrapper.callStatic().execute(n,s,o,c);case 12:return t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t.catch(9),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,this,[[9,15]])})));return function(r){return t.apply(this,arguments)}}()},{key:"balance",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(){var r;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contractWrapper.getProvider().getBalance(this.contractWrapper.address);case 2:return r=t.sent,t.abrupt("return",{name:"",symbol:"",decimals:18,value:r,displayValue:f.formatUnits(r,18)});case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"balanceOfToken",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r){var n,s;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve().then(e.t.bind(e,49242,19));case 2:return n=t.sent.default,t.t0=h.CH,t.next=6,(0,d.aM)(r);case 6:return t.t1=t.sent,t.t2=n,t.t3=this.contractWrapper.getProvider(),s=new t.t0(t.t1,t.t2,t.t3),t.t4=l.a,t.t5=this.contractWrapper.getProvider(),t.t6=r,t.next=15,s.balanceOf(this.contractWrapper.address);case 15:return t.t7=t.sent,t.next=18,(0,t.t4)(t.t5,t.t6,t.t7);case 18:return t.abrupt("return",t.sent);case 19:case"end":return t.stop()}}),t,this)})));return function(r){return t.apply(this,arguments)}}()},{key:"ensureExists",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.contractWrapper.read("state",[r]);case 3:t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),Error("Proposal ".concat(r," not found"));case 8:case"end":return t.stop()}}),t,this,[[0,5]])})));return function(r){return t.apply(this,arguments)}}()},{key:"settings",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(){var r,e,s,o,c,u,i,p;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([this.contractWrapper.read("votingDelay",[]),this.contractWrapper.read("votingPeriod",[]),this.contractWrapper.read("token",[]),this.contractWrapper.read("quorumNumerator",[]),this.contractWrapper.read("proposalThreshold",[])]);case 2:return r=t.sent,e=(0,n.Z)(r,5),s=e[0],o=e[1],c=e[2],u=e[3],i=e[4],t.next=11,(0,l.f)(this.contractWrapper.getProvider(),c);case 11:return p=t.sent,t.abrupt("return",{votingDelay:s.toString(),votingPeriod:o.toString(),votingTokenAddress:c,votingTokenMetadata:p,votingQuorumFraction:u.toString(),proposalTokenThreshold:i.toString()});case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"prepare",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r,e,n){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",v.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:r,args:e,overrides:n}));case 1:case"end":return t.stop()}}),t,this)})));return function(r,e,n){return t.apply(this,arguments)}}()},{key:"call",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(r,e,n){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.contractWrapper.call(r,e,n));case 1:case"end":return t.stop()}}),t,this)})));return function(r,e,n){return t.apply(this,arguments)}}()}]),t}())}}]);
//# sourceMappingURL=5590.fa172258.chunk.js.map
"use strict";(self.webpackChunkgeoblocs=self.webpackChunkgeoblocs||[]).push([[6491],{46491:function(e,r,t){t.d(r,{C:function(){return m}});var n=t(74165),a=t(29439),o=t(15861),s=t(15671),u=t(43144),c=t(4942),i=t(44554),p=t(68365),l=t(31109),f=t(36980),h=t(31714),m=function(){function e(r,t){var u=this;(0,s.Z)(this,e),(0,c.Z)(this,"featureName",p.d0.name),(0,c.Z)(this,"setAll",(0,f.d)(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t){var o,s,c,l,m,d,v,Z;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,e.t0){e.next=5;break}return e.next=4,u.contractWrapper.getSignerAddress();case 4:e.t0=e.sent;case 5:return o=e.t0,s=new h.C(u.contractWrapper),c=Object.keys(r),(0,i.Z)(c.length,"you must provide at least one role to set"),(0,i.Z)(c.every((function(e){return u.roles.includes(e)})),"this contract does not support the given role"),e.next=12,u.getAll();case 12:l=e.sent,m=[],d=c.sort((function(e){return"admin"===e?1:-1})),v=(0,n.Z)().mark((function e(){var t,c,i,f,h,v,g,k,x,w;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=d[Z],e.next=3,Promise.all([Promise.all((null===(t=r[i])||void 0===t?void 0:t.map((function(e){return(0,p.aL)(e)})))||[]),Promise.all((null===(c=l[i])||void 0===c?void 0:c.map((function(e){return(0,p.aL)(e)})))||[])]);case 3:if(f=e.sent,h=(0,a.Z)(f,2),v=h[0],g=h[1],k=v.filter((function(e){return!g.includes(e)})),(x=g.filter((function(e){return!v.includes(e)}))).length>1&&(w=x.indexOf(o))>-1&&(x.splice(w,1),x.push(o)),k.length&&k.forEach((function(e){m.push(s.encode("grantRole",[(0,p.H)(i),e]))})),!x.length){e.next=16;break}return e.next=14,Promise.all(x.map((function(e){return u.getRevokeRoleFunctionName(e)})));case 14:e.sent.forEach((function(e,r){return m.push(s.encode(e,[(0,p.H)(i),x[r]]))}));case 16:case"end":return e.stop()}}),e)})),Z=0;case 17:if(!(Z<d.length)){e.next=22;break}return e.delegateYield(v(),"t1",19);case 19:Z++,e.next=17;break;case 22:return e.abrupt("return",f.T.fromContractWrapper({contractWrapper:u.contractWrapper,method:"multicall",args:[m]}));case 23:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}())),(0,c.Z)(this,"grant",(0,f.d)(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,i.Z)(u.roles.includes(r),'this contract does not support the "'.concat(r,'" role')),e.next=3,(0,p.aL)(t);case 3:return a=e.sent,e.abrupt("return",f.T.fromContractWrapper({contractWrapper:u.contractWrapper,method:"grantRole",args:[(0,p.H)(r),a]}));case 5:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}())),(0,c.Z)(this,"revoke",(0,f.d)(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t){var a,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,i.Z)(u.roles.includes(r),'this contract does not support the "'.concat(r,'" role')),e.next=3,(0,p.aL)(t);case 3:return a=e.sent,e.next=6,u.getRevokeRoleFunctionName(a);case 6:return o=e.sent,e.abrupt("return",f.T.fromContractWrapper({contractWrapper:u.contractWrapper,method:o,args:[(0,p.H)(r),a]}));case 8:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}())),this.contractWrapper=r,this.roles=t}return(0,u.Z)(e,[{key:"getAll",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(){var r,t,o=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,i.Z)(this.roles.length,"this contract has no support for roles"),r={},t=Object.entries(this.roles),e.next=5,Promise.all(t.map((function(e){var r=(0,a.Z)(e,2)[1];return o.get(r)})));case 5:return e.sent.forEach((function(e,n){return r[t[n][1]]=e})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var t,a,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,i.Z)(this.roles.includes(r),'this contract does not support the "'.concat(r,'" role')),t=this.contractWrapper,!(0,l.h)("getRoleMemberCount",t)||!(0,l.h)("getRoleMember",t)){e.next=10;break}return a=(0,p.H)(r),e.next=6,t.read("getRoleMemberCount",[a]);case 6:return o=e.sent.toNumber(),e.next=9,Promise.all(Array.from(Array(o).keys()).map((function(e){return t.read("getRoleMember",[a,e])})));case 9:return e.abrupt("return",e.sent);case 10:throw new Error("Contract does not support enumerating roles. Please implement IPermissionsEnumerable to unlock this functionality.");case 11:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"verify",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r,t){var s=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(r.map(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var o,u,c,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([s.get(r),(0,p.aL)(t)]);case 2:if(o=e.sent,u=(0,a.Z)(o,2),c=u[0],i=u[1],c.map((function(e){return e.toLowerCase()})).includes(i.toLowerCase())){e.next=8;break}throw new p.o(i,r);case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()},{key:"getRevokeRoleFunctionName",value:function(){var e=(0,o.Z)((0,n.Z)().mark((function e(r){var t,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([(0,p.aL)(r),this.contractWrapper.getSignerAddress()]);case 2:if(t=e.sent,o=(0,a.Z)(t,2),s=o[0],o[1].toLowerCase()!==s.toLowerCase()){e.next=8;break}return e.abrupt("return","renounceRole");case 8:return e.abrupt("return","revokeRole");case 9:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=6491.81372480.chunk.js.map
"use strict";(self.webpackChunkgeoblocs=self.webpackChunkgeoblocs||[]).push([[759],{40759:function(e,t,n){n.r(t),n.d(t,{CoinbaseWalletConnector:function(){return k}});var r=n(29439),i=n(74165),s=n(15861),a=n(1413),c=n(15671),o=n(43144),u=n(97326),h=n(60136),d=n(29388),p=n(2600),v=n(69822),f=n(38690),l=n(97419),w=n(60723),g=n(49716),m=n(32928),Z=n(83506),x=n(91609),k=(n(65892),function(e){(0,h.Z)(v,e);var t=(0,d.Z)(v);function v(e){var n;(0,c.Z)(this,v);var r=e.chains,i=e.options;return n=t.call(this,{chains:r,options:(0,a.Z)({reloadOnDisconnect:!1},i)}),(0,p._)((0,u.Z)(n),"id",m.w.coinbase),(0,p._)((0,u.Z)(n),"name","Coinbase Wallet"),(0,p._)((0,u.Z)(n),"ready",!0),(0,p._)((0,u.Z)(n),"onAccountsChanged",(function(e){0===e.length?n.emit("disconnect"):n.emit("change",{account:l.getAddress(e[0])})})),(0,p._)((0,u.Z)(n),"onChainChanged",(function(e){var t=(0,x.n)(e),r=n.isChainUnsupported(t);n.emit("change",{chain:{id:t,unsupported:r}})})),(0,p._)((0,u.Z)(n),"onDisconnect",(function(){n.emit("disconnect")})),n}return(0,o.Z)(v,[{key:"connect",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t,n,r,s,a,c,o,u=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(u.length>0&&void 0!==u[0]?u[0]:{}).chainId,e.prev=1,e.next=4,this.getProvider();case 4:return n=e.sent,this.setupListeners(),this.emit("message",{type:"connecting"}),e.next=9,n.enable();case 9:return r=e.sent,s=l.getAddress(r[0]),e.next=13,this.getChainId();case 13:if(a=e.sent,c=this.isChainUnsupported(a),!t||a===t){e.next=27;break}return e.prev=16,e.next=19,this.switchChain(t);case 19:o=e.sent,a=o.chainId,c=this.isChainUnsupported(a),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(16),console.error("Connected but failed to switch to desired chain ".concat(t),e.t0);case 27:return e.abrupt("return",{account:s,chain:{id:a,unsupported:c},provider:new w.Q(n)});case 30:if(e.prev=30,e.t1=e.catch(1),!/(user closed modal|accounts received is empty)/i.test(e.t1.message)){e.next=34;break}throw new f.U(e.t1);case 34:throw e.t1;case 35:case"end":return e.stop()}}),e,this,[[1,30],[16,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._provider){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getProvider();case 4:(t=e.sent).removeListener("accountsChanged",this.onAccountsChanged),t.removeListener("chainChanged",this.onChainChanged),t.removeListener("disconnect",this.onDisconnect),t.disconnect(),t.close();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAccount",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:return t=e.sent,e.next=5,t.request({method:"eth_accounts"});case 5:if(0!==(n=e.sent).length){e.next=8;break}throw new Error("No accounts found");case 8:return e.abrupt("return",l.getAddress(n[0]));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getChainId",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:return t=e.sent,n=(0,x.n)(t.chainId),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getProvider",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t,r,s,a,c,o,u=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._provider){e.next=11;break}return e.next=3,Promise.all([n.e(3277),n.e(5419),n.e(6942)]).then(n.bind(n,25419));case 3:"function"!==typeof(r=e.sent.default)&&"function"===typeof r.default&&(r=r.default),this._client=new r(this.options),s=null===(t=this._client.walletExtension)||void 0===t?void 0:t.getChainId(),a=this.chains.find((function(e){return u.options.chainId?e.chainId===u.options.chainId:e.chainId===s}))||this.chains[0],c=this.options.chainId||(null===a||void 0===a?void 0:a.chainId),o=this.options.jsonRpcUrl||(null===a||void 0===a?void 0:a.rpc[0]),this._provider=this._client.makeWeb3Provider(o,c);case 11:return e.abrupt("return",this._provider);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSigner",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t,n,s,a,c,o=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(o.length>0&&void 0!==o[0]?o[0]:{}).chainId,e.next=3,Promise.all([this.getProvider(),this.getAccount()]);case 3:return n=e.sent,s=(0,r.Z)(n,2),a=s[0],c=s[1],e.abrupt("return",new w.Q(a,t).getSigner(c));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isAuthorized",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAccount();case 3:return t=e.sent,e.abrupt("return",!!t);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"switchChain",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r,s,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:return n=e.sent,r=g.hexValue(t),e.prev=4,e.next=7,n.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]});case 7:return e.abrupt("return",null!==(s=this.chains.find((function(e){return e.chainId===t})))&&void 0!==s?s:{chainId:t,name:"Chain ".concat(r),slug:"".concat(r),nativeCurrency:{name:"Ether",decimals:18,symbol:"ETH"},rpc:[""],testnet:!1,chain:"ethereum",shortName:"eth"});case 10:if(e.prev=10,e.t0=e.catch(4),a=this.chains.find((function(e){return e.chainId===t}))){e.next=15;break}throw new f.C({chainId:t,connectorId:this.id});case 15:if(4902!==e.t0.code){e.next=27;break}return e.prev=16,e.next=19,n.request({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:a.name,nativeCurrency:a.nativeCurrency,rpcUrls:(0,Z.g)(a),blockExplorerUrls:this.getBlockExplorerUrls(a)}]});case 19:return e.abrupt("return",a);case 22:if(e.prev=22,e.t1=e.catch(16),!this._isUserRejectedRequestError(e.t1)){e.next=26;break}throw new f.U(e.t1);case 26:throw new f.A;case 27:if(!this._isUserRejectedRequestError(e.t0)){e.next=29;break}throw new f.U(e.t0);case 29:throw new f.S(e.t0);case 30:case"end":return e.stop()}}),e,this,[[4,10],[16,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isUserRejectedRequestError",value:function(e){return/(user rejected)/i.test(e.message)}},{key:"setupListeners",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:(t=e.sent).on("accountsChanged",this.onAccountsChanged),t.on("chainChanged",this.onChainChanged),t.on("disconnect",this.onDisconnect);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getQrUrl",value:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:if(this._client){e.next=4;break}throw new Error("Coinbase Wallet SDK not initialized");case 4:return e.abrupt("return",this._client.getQrUrl());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),v}(v.W))}}]);
//# sourceMappingURL=759.4ce095a1.chunk.js.map
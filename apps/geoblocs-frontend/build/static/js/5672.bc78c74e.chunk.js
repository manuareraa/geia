"use strict";(self.webpackChunkgeoblocs=self.webpackChunkgeoblocs||[]).push([[5672],{18052:function(e,n,t){function r(e){return"string"===typeof e?Number.parseInt(e,"0x"===e.trim().substring(0,2)?16:10):"bigint"===typeof e?Number(e):e}t.d(n,{n:function(){return r}})},15672:function(e,n,t){t.r(n),t.d(n,{PaperWalletConnector:function(){return g}});var r=t(74165),a=t(15861),s=t(15671),i=t(43144),u=t(97326),o=t(60136),c=t(29388),p=t(9302),h=t(95171),d=t(97419),l=t(18052),f=t(39416),v=t(57591),g=(t(38080),function(e){(0,o.Z)(v,e);var n=(0,c.Z)(v);function v(e){var t;return(0,s.Z)(this,v),t=n.call(this),(0,p._)((0,u.Z)(t),"id",f.w.paper),(0,p._)((0,u.Z)(t),"name","Paper Wallet"),(0,p._)((0,u.Z)(t),"ready",!0),(0,p._)((0,u.Z)(t),"user",null),(0,p._)((0,u.Z)(t),"onAccountsChanged",function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.length){e.next=5;break}return e.next=3,t.onDisconnect();case 3:e.next=6;break;case 5:t.emit("change",{account:d.getAddress(n[0])});case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),(0,p._)((0,u.Z)(t),"onChainChanged",(function(e){var n=(0,l.n)(e),r=-1===t.options.chains.findIndex((function(e){return e.chainId===n}));t.emit("change",{chain:{id:n,unsupported:r}})})),(0,p._)((0,u.Z)(t),"onDisconnect",(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.emit("disconnect");case 1:case"end":return e.stop()}}),e)})))),t.options=e,t}return(0,i.Z)(v,[{key:"getPaperSDK",value:function(){var e=this;return this.paper||(this.paper=new Promise(function(){var n=(0,a.Z)((0,r.Z)().mark((function n(a,s){var i,u,o,c,p;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=null===(i=e.options.advancedOptions)||void 0===i?void 0:i.recoveryShareManagement,n.prev=1,n.next=4,Promise.resolve().then(t.bind(t,95171));case 4:o=n.sent,c=o.PaperEmbeddedWalletSdk,p={AWS_MANAGED:h.RecoveryShareManagement.AWS_MANAGED,USER_MANAGED:h.RecoveryShareManagement.USER_MANAGED},a(new c({advancedOptions:{recoveryShareManagement:u?p[u]:void 0},clientId:e.options.clientId,chain:"Ethereum",styles:e.options.styles,onAuthSuccess:e.options.onAuthSuccess})),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),s(n.t0);case 14:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e,t){return n.apply(this,arguments)}}())),this.paper}},{key:"connect",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t,a,s,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPaperSDK();case 2:if(t=e.sent){e.next=5;break}throw new Error("Paper SDK not initialized");case 5:return e.next=7,t.getUser();case 7:a=e.sent,e.t0=a.status,e.next=e.t0===h.UserStatus.LOGGED_OUT?11:e.t0===h.UserStatus.LOGGED_IN_WALLET_INITIALIZED?35:38;break;case 11:if(null===n||void 0===n||!n.googleLogin){e.next=18;break}return i=n.googleLogin,e.next=15,t.auth.loginWithGoogle("object"===typeof i?i:void 0);case 15:s=e.sent,e.next=33;break;case 18:if(null===n||void 0===n||!n.email||null===n||void 0===n||!n.otp){e.next=24;break}return e.next=21,t.auth.verifyPaperEmailLoginOtp({email:n.email,otp:n.otp,recoveryCode:n.recoveryCode});case 21:s=e.sent,e.next=33;break;case 24:if(null===n||void 0===n||!n.email){e.next=30;break}return e.next=27,t.auth.loginWithPaperEmailOtp({email:n.email});case 27:s=e.sent,e.next=33;break;case 30:return e.next=32,t.auth.loginWithPaperModal();case 32:s=e.sent;case 33:return this.user=s.user,e.abrupt("break",38);case 35:return"object"===typeof(null===n||void 0===n?void 0:n.googleLogin)&&n.googleLogin.closeOpenedWindow&&n.googleLogin.openedWindow&&n.googleLogin.closeOpenedWindow(n.googleLogin.openedWindow),this.user=a,e.abrupt("break",38);case 38:if(this.user){e.next=40;break}throw new Error("Error connecting User");case 40:return null!==n&&void 0!==n&&n.chainId&&this.switchChain(n.chainId),this.setupListeners(),e.abrupt("return",this.getAddress());case 43:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.paper;case 2:return n=e.sent,e.next=5,null===n||void 0===n?void 0:n.auth.logout();case 5:this._signer=void 0,this.user=null;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAddress",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSigner();case 2:return n=e.sent,e.abrupt("return",n.getAddress());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isConnected",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAddress();case 3:return n=e.sent,e.abrupt("return",!!n);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"getProvider",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSigner();case 2:if((n=e.sent).provider){e.next=5;break}throw new Error("Provider not found");case 5:return e.abrupt("return",n.provider);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSigner",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n,t,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._signer){e.next=2;break}return e.abrupt("return",this._signer);case 2:if(this.user){e.next=14;break}return e.next=5,this.getPaperSDK();case 5:return t=e.sent,e.next=8,t.getUser();case 8:a=e.sent,e.t0=a.status,e.next=e.t0===h.UserStatus.LOGGED_IN_WALLET_INITIALIZED?12:14;break;case 12:return this.user=a,e.abrupt("break",14);case 14:return e.next=16,null===(n=this.user)||void 0===n?void 0:n.wallet.getEthersJsSigner({rpcEndpoint:this.options.chain.rpc[0]||""});case 16:if(s=e.sent){e.next=19;break}throw new Error("Signer not found");case 19:return this._signer=s,e.abrupt("return",s);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isAuthorized",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"switchChain",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.options.chains.find((function(e){return e.chainId===n}))){e.next=3;break}throw new Error("Chain not configured");case 3:return e.next=5,null===(t=this.user)||void 0===t?void 0:t.wallet.setChain({chain:"Ethereum"});case 5:return e.next=7,null===(a=this.user)||void 0===a?void 0:a.wallet.getEthersJsSigner({rpcEndpoint:s.rpc[0]||""});case 7:this._signer=e.sent,this.emit("change",{chain:{id:n,unsupported:!1}});case 9:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"setupListeners",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:(n=e.sent).on&&(n.on("accountsChanged",this.onAccountsChanged),n.on("chainChanged",this.onChainChanged),n.on("disconnect",this.onDisconnect));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateChains",value:function(e){this.options.chains=e}},{key:"getEmail",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider();case 2:if(this.user){e.next=4;break}throw new Error("No user found, Paper Wallet is not connected");case 4:return e.abrupt("return",this.user.authDetails.email);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),v}(v.C))}}]);
//# sourceMappingURL=5672.bc78c74e.chunk.js.map